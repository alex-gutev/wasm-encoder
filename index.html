<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.9">
<meta name="author" content="Alexander Gutev">
<title>WASM-ENCODER</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article">
<div id="header">
<h1>WASM-ENCODER</h1>
<div class="details">
<span id="author" class="author">Alexander Gutev</span><br>
<span id="email" class="email">&lt;<a href="mailto:alex.gutev@mail.bg">alex.gutev@mail.bg</a>&gt;</span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This is a simple library for serializing a representation of
WebAssembly modules to the binary wasm format.</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#documentation">Documentation</a>
<ul class="sectlevel2">
<li><a href="#value_types">Value Types</a></li>
<li><a href="#instructions">Instructions</a>
<ul class="sectlevel3">
<li><a href="#branch_instructions">Branch Instructions</a></li>
<li><a href="#call_instructions">Call Instructions</a></li>
<li><a href="#select_instruction">Select Instruction</a></li>
<li><a href="#local_and_global_variable_instructions">Local and Global Variable Instructions</a></li>
<li><a href="#memory_instructions">Memory Instructions</a></li>
<li><a href="#constant_instructions">Constant Instructions</a></li>
<li><a href="#reference_instructions">Reference Instructions</a></li>
<li><a href="#memory_and_table_instructions">Memory and Table Instructions</a></li>
<li><a href="#structured_block_instructions">Structured Block Instructions</a></li>
</ul>
</li>
<li><a href="#modules">Modules</a>
<ul class="sectlevel3">
<li><a href="#wasm_module">WASM-MODULE</a></li>
<li><a href="#serialize_module">SERIALIZE-MODULE</a></li>
</ul>
</li>
<li><a href="#type_section">Type Section</a>
<ul class="sectlevel3">
<li><a href="#wasm_function_type">WASM-FUNCTION-TYPE</a></li>
</ul>
</li>
<li><a href="#imports_section">Imports Section</a>
<ul class="sectlevel3">
<li><a href="#wasm_import">WASM-IMPORT</a></li>
</ul>
</li>
<li><a href="#functions">Functions</a>
<ul class="sectlevel3">
<li><a href="#wasm_function">WASM-FUNCTION</a></li>
</ul>
</li>
<li><a href="#memory_and_table_sections">Memory and Table Sections</a>
<ul class="sectlevel3">
<li><a href="#wasm_limit">WASM-LIMIT</a></li>
<li><a href="#wasm_table">WASM-TABLE</a></li>
</ul>
</li>
<li><a href="#global_variable_section">Global Variable Section</a>
<ul class="sectlevel3">
<li><a href="#wasm_global">WASM-GLOBAL</a></li>
</ul>
</li>
<li><a href="#exports_section">Exports Section</a>
<ul class="sectlevel3">
<li><a href="#wasm_export">WASM-EXPORT</a></li>
</ul>
</li>
<li><a href="#start_function">Start Function</a></li>
<li><a href="#element_section">Element Section</a>
<ul class="sectlevel3">
<li><a href="#wasm_element">WASM-ELEMENT</a></li>
<li><a href="#wasm_element_init_index">WASM-ELEMENT-INIT-INDEX</a></li>
<li><a href="#wasm_element_init_expressions">WASM-ELEMENT-INIT-EXPRESSIONS</a></li>
</ul>
</li>
<li><a href="#data_section">Data Section</a>
<ul class="sectlevel3">
<li><a href="#wasm_data">WASM-DATA</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="documentation">Documentation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="value_types">Value Types</h3>
<div class="paragraph">
<p>The value types of various entities, such as global variables,
function arguments and return values, local and global variables, are
identified by the following symbols:</p>
</div>
<div class="dlist">
<div class="title">Numeric Types</div>
<dl>
<dt class="hdlist1"><code>I32</code></dt>
<dd>
<p>32-bit integer</p>
</dd>
<dt class="hdlist1"><code>I64</code></dt>
<dd>
<p>64-bit integer</p>
</dd>
<dt class="hdlist1"><code>F32</code></dt>
<dd>
<p>32-bit single precision floating point value</p>
</dd>
<dt class="hdlist1"><code>F64</code></dt>
<dd>
<p>64-bit double precision floating point value</p>
</dd>
</dl>
</div>
<div class="dlist">
<div class="title">Reference Types</div>
<dl>
<dt class="hdlist1"><code>FUNCREF</code></dt>
<dd>
<p>Function reference</p>
</dd>
<dt class="hdlist1"><code>EXTERNREF</code></dt>
<dd>
<p>All reference objects that can be passed to WebAssembly</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A symbol is considered equivalent to one of the above if its
symbol name is equivalent, regardless of its package. Thus you don&#8217;t
have to import <code>I32</code>, etc from the <code>WASM-ENCODER</code> package.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="instructions">Instructions</h3>
<div class="paragraph">
<p>A WebAssembly instruction is represented by a symbol of which the
symbol name is equal to the instruction&#8217;s mnemonic. Any symbol, in any
package, with a symbol name that is equal to a WebAssembly instruction
mnemonic can be used.</p>
</div>
<div class="paragraph">
<p>Instructions which accept static options are represented by a list in
which the first element (the <code>CAR</code>) is the instruction mnemonic and
the remaining elements are the options. The interpretation of the
options depends on the instruction.</p>
</div>
<div class="sect3">
<h4 id="branch_instructions">Branch Instructions</h4>
<div class="paragraph">
<p>The <code>BR</code> and <code>BR_IF</code> branch instructions each take a single option, an
unsigned integer interpreted as the index of the block which is the
branch target.</p>
</div>
<div class="paragraph">
<p>The <code>BR_TABLE</code> takes a variable number of options, where each option
is an unsigned integer, interpreted as a block index.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre>(BR 0)            ;; Branch to block 0
(BR_IF 2)         ;; Branch to block 2
(BR_TABLE 0 1 2)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="call_instructions">Call Instructions</h4>
<div class="paragraph">
<p>The <code>CALL</code> instruction takes a single option, an unsigned integer
interpreted as the index of the function being called.</p>
</div>
<div class="paragraph">
<p>The <code>CALL_INDIRECT</code> instruction takes a single option, an unsigned
integer interpreted as the index, within the type section, of the
function&#8217;s type signature.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre>(CALL 5)             ;; Call function 5
(CALL_INDIRECT 2)    ;; Indirect call to a function with type signature index 2</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="select_instruction">Select Instruction</h4>
<div class="paragraph">
<p>The select instruction takes an optional list of type identifier which
represent the value types of the operands to be selected. If there is
more than one type specifier then there is more than one value per
operand.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>(select f32 f64)</pre>
</div>
</div>
<div class="paragraph">
<p>In the above example <code>SELECT</code> consumes, off the stack, two operands,
following the condition, each consisting of two values the first being
an <code>F32</code> and the second being an <code>F64</code>. The two values of the result
operand, of type <code>F32</code> and <code>F64</code>, are pushed back onto the stack.</p>
</div>
<div class="paragraph">
<p>If <code>SELECT</code> is not given the type identifier of it&#8217;s operand values,
the operands must be of a numeric type.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the current version of WebAssembly <code>SELECT</code> may only specify
a single value type, for a single value per operand. This library
supports <code>SELECT</code> with multiple operand value types.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="local_and_global_variable_instructions">Local and Global Variable Instructions</h4>
<div class="paragraph">
<p>The instructions for retrieving/setting the value of a local/global
variable, each take a single options, an unsigned integer interpreted
as the local/global variable index.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LOCAL.GET</code></p>
</li>
<li>
<p><code>LOCAL.SET</code></p>
</li>
<li>
<p><code>LOCAL.TEE</code></p>
</li>
<li>
<p><code>GLOBAL.GET</code></p>
</li>
<li>
<p><code>GLOBAL.SET</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="memory_instructions">Memory Instructions</h4>
<div class="paragraph">
<p>Memory load/store instructions take an optional list specifying the
expected alignment and offset. These operands take the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(I32.STORE (ALIGN a) (OFFSET o)) ;; Alignment = a, Offset = o</pre>
</div>
</div>
<div class="paragraph">
<p>The alignment option is a list of two elements where the first element
is a symbol, with name <code>ALIGN</code>, and the second element is an unsigned
integer specifying the alignment as a power of two. If the alignment
option is omitted a default alignment of <code>2</code> is assumed.</p>
</div>
<div class="paragraph">
<p>The offset option is a list of two elements where the first element is
a symbol, with name <code>OFFSET</code>, and the second element is an unsigned
integer specifying the offset. If this option is omitted a default
offset of <code>0</code> is assumed.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
As with the instruction mnemonics any symbol, in any package,
with symbol name <code>ALIGN</code> or <code>OFFSET</code> can be used to specify the
alignment and offset options.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The alignment and offset options can be specified in any order and
either one, or both, can be omitted. If both options are omitted the
instruction can either take the form of a list containing only the
instruction mnemonic, or the instruction mnemonic symbol by itself.</p>
</div>
<div class="listingblock">
<div class="title">Examples:</div>
<div class="content">
<pre>(I32.LOAD (OFFSET 8)) ;; Offset = 8
(I32.STORE (ALIGN 1)) ;; Alignment = 1
I64.STORE             ;; Default Alignment = 2 and Offset = 0</pre>
</div>
</div>
<div class="paragraph">
<p>The instructions falling within this group are all the typed <code>xx.LOAD</code>
and <code>xx.STORE</code> instructions (where <code>xx</code> is the value type), including
the instructions with a storage size which is smaller than the size of
the type.</p>
</div>
</div>
<div class="sect3">
<h4 id="constant_instructions">Constant Instructions</h4>
<div class="paragraph">
<p>Constant instructions take a single option which is the literal
constant value.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>I32.CONST</code> and <code>I64.CONST</code> take either a signed or unsigned 32-bit
(64-bit in the case of <code>I64.CONST</code>) integer option. However,
regardless of whether the operand value is signed or not, the value
itself is always encoded as a signed integer in twos-complement.</p>
</li>
<li>
<p><code>F32.CONST</code> takes a single precision floating-point
(<code>SINGLE-FLOAT</code>) value as its option.</p>
</li>
<li>
<p><code>F64.CONST</code> takes either a single or double precision floating-point
value as its option.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="reference_instructions">Reference Instructions</h4>
<div class="paragraph">
<p>The <code>REF.NULL</code> instruction takes a single option which is interpreted
as the reference type identifier, either <code>FUNCREF</code> or <code>EXTERNREF</code>. See
<a href="#value_types">Value Types</a>.</p>
</div>
<div class="paragraph">
<p>The <code>REF.FUNC</code> instruction takes a single option, an unsigned integer
interpreted as the index of the function, within the function section,
to which to return a reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="memory_and_table_instructions">Memory and Table Instructions</h4>
<div class="paragraph">
<p>The <code>MEMORY.INIT</code> and <code>DATA.DROP</code> instructions both take a single
option, an unsigned integer which is interpreted as the index of a
data segment within the data section.</p>
</div>
<div class="paragraph">
<p>The <code>TABLE.INIT</code> and <code>TABLE.COPY</code> instructions take two options, both
unsigned integers which are interpreted as a table index and element
segment index.</p>
</div>
<div class="paragraph">
<p>The <code>ELEM.DROP</code> instruction takes a single instruction, an unsigned
integer interpreted as an element segment index.</p>
</div>
<div class="paragraph">
<p>The <code>TABLE.GET</code>, <code>TABLE.SET</code>, <code>TABLE.SIZE</code>, <code>TABLE.GROW</code> and
<code>TABLE.FILL</code> instructions each take a single option, an unsigned
integer interpreted as a table index.</p>
</div>
</div>
<div class="sect3">
<h4 id="structured_block_instructions">Structured Block Instructions</h4>
<div class="paragraph">
<p>Structured block instructions are represented by a list with the block
type in the first element being and the instructions, comprising the
body of the block, in the remaining elements.</p>
</div>
<div class="paragraph">
<p>The second element of the list may be either an instruction, in which
case it is the first instruction of the block, or one of the
following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>(RESULT type)</code></dt>
<dd>
<p>Indicates the type of value returned (on the stack)
by the block, where <code>type</code> is the value type identifier, see
<a href="#value_types">Value Types</a>.</p>
</dd>
<dt class="hdlist1"><code>(TYPE index)</code></dt>
<dd>
<p>Indicates the of the values consumed (from the stack)
and returned by the block, where <code>index</code> is the index of a function
type specifier, with the type section, see <a href="#type_section">Type Section</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If neither a result type nor type signature is specified, then it is
assumed that the block neither consumes nor returns a value and hence
does not have a return value type.</p>
</div>
<div class="paragraph">
<p>The <code>BLOCK</code> and <code>LOOP</code> block instructions follow this representation
exactly.</p>
</div>
<div class="listingblock">
<div class="title">Example: Simple block (no result type)</div>
<div class="content">
<pre>(block
  (local.get 1)
  (br_if 0)
  (call 0))</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Block with result type</div>
<div class="content">
<pre>(block (result i32)
  (local.get 1)
  (br_if 0)

  (local.get 2)
  (local.get 3)
  i32.add)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Block with type signature</div>
<div class="content">
<pre>(block (type 1) ;; (i32 i32 i32) =&gt; i32
  i32.add
  i32.mul)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Simple loop</div>
<div class="content">
<pre>(loop
  (call 0)
  (local.get 1)
  (i32.const 5)
  i32.lt
  (br_if 0))</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>IF</code> instruction is represented by a list of the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(IF (THEN instructions...)
    (ELSE instructions...))</pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>instructions</code> are the instructions comprising the body of the
<code>THEN</code> and <code>ELSE</code> branches. The <code>(ELSE &#8230;&#8203;)</code> element may be omitted in
which case the if instruction does not have an else branch.</p>
</div>
<div class="paragraph">
<p>The <code>IF</code> instruction may also have an optional result type or type
signature specified in the second element by <code>(RESULT type)</code> or <code>(TYPE
index)</code>. If this is omitted the <code>IF</code> instruction is assumed to have no
result type.</p>
</div>
<div class="listingblock">
<div class="title">Example: If without else branch</div>
<div class="content">
<pre>(local.get 0)
(if (then (call 0))</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: If with else branch</div>
<div class="content">
<pre>(local.get 0)
(if (then (call 0))
    (else (call 1)))</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: If with result type</div>
<div class="content">
<pre>(local.get 0)
(i32.const 0)
i32.ge

(if (result i32)
    (then (local.get 0))
    (else (local.get 0)
          (i32.const -1)
          i32.mul))</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modules">Modules</h3>
<div class="paragraph">
<p>A WebAssembly module is represented by the <code>WASM-MODULE</code> structure,
which contains a slot for each section. A <code>WASM-MODULE</code> object can be
serialized to an output stream using the <code>SERIALIZE-MODULE</code> function.</p>
</div>
<div class="sect3">
<h4 id="wasm_module">WASM-MODULE</h4>
<div class="paragraph">
<p>Structure: <code>WASM-MODULE</code></p>
</div>
<div class="paragraph">
<p>Represents a WebAssembly module with a lot for each section:</p>
</div>
<div class="paragraph">
<p>Slots:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TYPES</code></p>
</li>
<li>
<p><code>IMPORTS</code></p>
</li>
<li>
<p><code>FUNCTIONS</code></p>
</li>
<li>
<p><code>TABLES</code></p>
</li>
<li>
<p><code>MEMORY</code></p>
</li>
<li>
<p><code>GLOBALS</code></p>
</li>
<li>
<p><code>EXPORTS</code></p>
</li>
<li>
<p><code>START</code></p>
</li>
<li>
<p><code>ELEMENTS</code></p>
</li>
<li>
<p><code>DATA</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="serialize_module">SERIALIZE-MODULE</h4>
<div class="paragraph">
<p>Function: <code>SERIALIZE-MODULE MODULE STREAM</code></p>
</div>
<div class="paragraph">
<p>Serialize a module to the wasm binary format and write the output to a
given stream.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>MODULE</code></dt>
<dd>
<p>The <code>WASM-MODULE</code> to serialize.</p>
</dd>
<dt class="hdlist1"><code>STREAM</code></dt>
<dd>
<p>Output stream to which to serialize the module. This must
be a binary output stream with element type <code>(UNSIGNED-BYTE 8)</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="type_section">Type Section</h3>
<div class="paragraph">
<p>The <code>TYPES</code> slot, of <code>WASM-MODULE</code> ,is a list of <code>WASM-FUNCTION-TYPE</code>
objects which represent the function type signatures of the module&#8217;s
functions.</p>
</div>
<div class="sect3">
<h4 id="wasm_function_type">WASM-FUNCTION-TYPE</h4>
<div class="paragraph">
<p>Structure: <code>WASM-FUNCTION-TYPE</code></p>
</div>
<div class="paragraph">
<p>Represents a function type signature.</p>
</div>
<div class="paragraph">
<p>Slots:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>PARAMS</code></dt>
<dd>
<p>List of the argument types</p>
</dd>
<dt class="hdlist1"><code>RESULTS</code></dt>
<dd>
<p>List of the return value types</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="imports_section">Imports Section</h3>
<div class="paragraph">
<p>The <code>IMPORTS</code> slot, of <code>WASM-MODULE</code>, is a list of <code>WASM-IMPORT</code>
objects which represent the module&#8217;s imports.</p>
</div>
<div class="sect3">
<h4 id="wasm_import">WASM-IMPORT</h4>
<div class="paragraph">
<p>Structure: <code>WASM-IMPORT</code></p>
</div>
<div class="paragraph">
<p>Represents an imported entity.</p>
</div>
<div class="paragraph">
<p>Slots:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>MODULE</code></dt>
<dd>
<p>Module component (first level) of the import name</p>
</dd>
<dt class="hdlist1"><code>NAME</code></dt>
<dd>
<p>Name component (second level) of the import name</p>
</dd>
<dt class="hdlist1"><code>TYPE</code></dt>
<dd>
<p>Keyword identifying type of imported entity:</p>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>:FUNC</code></dt>
<dd>
<p>The imported entity is a function</p>
</dd>
<dt class="hdlist1"><code>:TABLE</code></dt>
<dd>
<p>The imported entity is a table object</p>
</dd>
<dt class="hdlist1"><code>:MEMORY</code></dt>
<dd>
<p>The imported entity is a memory object</p>
</dd>
<dt class="hdlist1"><code>:GLOBAL</code></dt>
<dd>
<p>The imported entity is a global variable</p>
</dd>
</dl>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>DESC</code></dt>
<dd>
<p>Description of the imported entity, which depends on <code>TYPE</code>:</p>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>:FUNC</code></dt>
<dd>
<p>Index of the function&#8217;s type signature within the module&#8217;s
type section.</p>
</dd>
<dt class="hdlist1"><code>:TABLE</code></dt>
<dd>
<p>A <code>WASM-TABLE</code> object specifying the table type and limits.</p>
</dd>
<dt class="hdlist1"><code>:MEMORY</code></dt>
<dd>
<p>A <code>WASM-LIMIT</code> object specifying the memory limits.</p>
</dd>
<dt class="hdlist1"><code>:GLOBAL</code></dt>
<dd>
<p>A list of the form <code>(TYPE MUTABLE-P)</code> where <code>TYPE</code> is the
value type of the variable and <code>MUTABLE-P</code> is a flag, which if true,
indicates that the variable is mutable.</p>
</dd>
</dl>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="functions">Functions</h3>
<div class="paragraph">
<p>The slot <code>FUNCTIONS</code>, of <code>WASM-MODULE</code>, is a list of <code>WASM-FUNCTION</code>
objects which represent the module&#8217;s functions.</p>
</div>
<div class="sect3">
<h4 id="wasm_function">WASM-FUNCTION</h4>
<div class="paragraph">
<p>Structure: <code>WASM-FUNCTION</code></p>
</div>
<div class="paragraph">
<p>Represents a function.</p>
</div>
<div class="paragraph">
<p>Slots:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>TYPE</code></dt>
<dd>
<p>Index of the function&#8217;s type signature within the type section.</p>
</dd>
<dt class="hdlist1"><code>LOCALS</code></dt>
<dd>
<p>List of the types of the local variables.</p>
</dd>
<dt class="hdlist1"><code>CODE</code></dt>
<dd>
<p>List of instructions comprising the body of the function.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="memory_and_table_sections">Memory and Table Sections</h3>
<div class="paragraph">
<p>The <code>MEMORY</code> slot is a list of <code>WASM-LIMIT</code> objects which specify the
limits of the module&#8217;s memory objects.</p>
</div>
<div class="paragraph">
<p>The slot <code>TABLES</code>, of <code>WASM-MODULE</code>, is a list of <code>WASM-TABLE</code> objects
which specify the type and limits of the module&#8217;s table objects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the current version of WebAssembly, modules may contain a
maximum of one table and memory object. This library supports
serializing modules with more than one memory and table object.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="wasm_limit">WASM-LIMIT</h4>
<div class="paragraph">
<p>Structure: <code>WASM-LIMIT</code></p>
</div>
<div class="paragraph">
<p>Specifies the limits of a memory and table objects.</p>
</div>
<div class="paragraph">
<p>Slots:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>MIN</code></dt>
<dd>
<p>The lower-bound of the memory / table limit. Must be greater
than or equal to 0.</p>
</dd>
<dt class="hdlist1"><code>MAX</code></dt>
<dd>
<p>The upper-bound of the limit. If NIL the limit has no
upper-bound.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="wasm_table">WASM-TABLE</h4>
<div class="paragraph">
<p>Structure: <code>WASM-TABLE (:INCLUDE WASM-LIMIT)</code></p>
</div>
<div class="paragraph">
<p>Specifies the type and limits of a table object. Includes the slots of
the structure <code>WASM-LIMIT</code>.</p>
</div>
<div class="paragraph">
<p>Slots:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>TYPE</code></dt>
<dd>
<p>Table element type, either <code>FUNCREF</code> (the default) or <code>EXTERNREF</code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the current version of WebAssembly only tables of type
<code>FUNCREF</code> are supported.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="global_variable_section">Global Variable Section</h3>
<div class="paragraph">
<p>The <code>GLOBALS</code> slot, of <code>WASM-MODULE</code>, is a list of <code>WASM-GLOBAL</code>
objects which represent the module&#8217;s global variables.</p>
</div>
<div class="sect3">
<h4 id="wasm_global">WASM-GLOBAL</h4>
<div class="paragraph">
<p>Structure: <code>WASM-GLOBAL</code></p>
</div>
<div class="paragraph">
<p>Represents a global variable</p>
</div>
<div class="dlist">
<div class="title">Slots</div>
<dl>
<dt class="hdlist1"><code>TYPE</code></dt>
<dd>
<p>Value type of the variable.</p>
</dd>
<dt class="hdlist1"><code>MUTABLE-P</code></dt>
<dd>
<p>Flag, which if true, indicates the variable is
mutable. Otherwise the variable is immutable.</p>
</dd>
<dt class="hdlist1"><code>INIT</code></dt>
<dd>
<p>Expression which computes the variable&#8217;s initial value. May
be <code>NIL</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exports_section">Exports Section</h3>
<div class="paragraph">
<p>The <code>EXPORTS</code> slot, of <code>WASM-MODULE</code>, is a list of <code>WASM-EXPORT</code>
objects which represent the entities exported by the module.</p>
</div>
<div class="sect3">
<h4 id="wasm_export">WASM-EXPORT</h4>
<div class="paragraph">
<p>Structure: <code>WASM-EXPORT</code></p>
</div>
<div class="paragraph">
<p>Represents an exported entity.</p>
</div>
<div class="dlist">
<div class="title">Slots</div>
<dl>
<dt class="hdlist1"><code>NAME</code></dt>
<dd>
<p>The name (as a string) under which the entity is exported.</p>
</dd>
<dt class="hdlist1"><code>TYPE</code></dt>
<dd>
<p>Keyword describing the type of entity. See the <code>TYPE</code> slot of
<a href="#wasm_import">WASM-IMPORT</a>.</p>
</dd>
<dt class="hdlist1"><code>INDEX</code></dt>
<dd>
<p>Index of the exported entity within its sections.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="start_function">Start Function</h3>
<div class="paragraph">
<p>The <code>START</code> slot, of <code>WASM-MODULE</code>, is the index of the function, with
functions list in the <code>FUNCTIONS</code> slot, of the function which serves
as the module&#8217;s entry point. If <code>NIL</code> the module does not have an
entry point.</p>
</div>
</div>
<div class="sect2">
<h3 id="element_section">Element Section</h3>
<div class="paragraph">
<p>The <code>ELEMENTS</code> slot, of <code>WASM-MODULE</code>, is a list of <code>WASM-ELEMENT</code>
objects which represent the module&#8217;s element segments.</p>
</div>
<div class="paragraph">
<p>Each element segment specifies the initial values of a range of
elements in a table object.</p>
</div>
<div class="sect3">
<h4 id="wasm_element">WASM-ELEMENT</h4>
<div class="paragraph">
<p>Structure <code>WASM-ELEMENT</code></p>
</div>
<div class="paragraph">
<p>Represents an element segment.</p>
</div>
<div class="dlist">
<div class="title">Slots</div>
<dl>
<dt class="hdlist1"><code>MODE</code></dt>
<dd>
<p>Keyword specifying the element segment mode.</p>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>:ACTIVE</code></dt>
<dd>
<p>An 'active' segment , which is used to initialize the
table elements during module instantiation. This is the default.</p>
</dd>
<dt class="hdlist1"><code>:PASSIVE</code></dt>
<dd>
<p>A 'passive' segment, which can be used to initialize the
table elements at runtime with the <code>TABLE.INIT</code> instruction.</p>
</dd>
<dt class="hdlist1"><code>:DECLARATIVE</code></dt>
<dd>
<p>A 'declarative' segment, which is used only to
forward declare the function references that will be added to the
table, using the <code>REF.FUNC</code> instruction.</p>
</dd>
</dl>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>INDEX</code></dt>
<dd>
<p>Index of the table object, 0 by default, which this element
initializes. This slot is only used when <code>MODE</code> is <code>:ACTIVE</code>.</p>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the current version of WebAssembly the only valid index is 0.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>OFFSET</code></dt>
<dd>
<p>Expression which computes the starting index of the
location within the table where the elements in this segment are
copied to.</p>
</dd>
<dt class="hdlist1"><code>INIT</code></dt>
<dd>
<p>Object specifying the values of the elements in this
segment. This can be either a <code>WASM-ELEMENT-INIT-INDEX</code> or
<code>WASM-ELEMENT-INIT-EXPRESSIONS</code> object.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="wasm_element_init_index">WASM-ELEMENT-INIT-INDEX</h4>
<div class="paragraph">
<p>Structure <code>WASM-ELEMENT-INIT-INDEX</code></p>
</div>
<div class="paragraph">
<p>Represents a table element segment where the initial element values
are function indices.</p>
</div>
<div class="dlist">
<div class="title">Slots</div>
<dl>
<dt class="hdlist1"><code>FUNCTIONS</code></dt>
<dd>
<p>List of indices of the functions, within the function
section (<code>FUNCTIONs</code> slot), to which the table elements are set.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="wasm_element_init_expressions">WASM-ELEMENT-INIT-EXPRESSIONS</h4>
<div class="paragraph">
<p>Structure <code>WASM-ELEMENT-INIT-EXPRESSIONS</code></p>
</div>
<div class="paragraph">
<p>Represents a table element segment where the initial element values
are computed by expressions.</p>
</div>
<div class="dlist">
<div class="title">Slots</div>
<dl>
<dt class="hdlist1"><code>TYPE</code></dt>
<dd>
<p>Table element type, either <code>FUNCREF</code> (default) or
<code>EXTERNREF</code>.</p>
</dd>
<dt class="hdlist1"><code>EXPRESSIONS</code></dt>
<dd>
<p>List of expressions which compute the initial element
values. Each expression should leave a function reference on the
stack, which is obtained with the <code>REF.FUNC</code> instruction.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="data_section">Data Section</h3>
<div class="paragraph">
<p>The <code>DATA</code> slot, of <code>WASM-MODULE</code>, is a list of <code>WASM-DATA</code> objects
which represent the module&#8217;s data segments.</p>
</div>
<div class="paragraph">
<p>Each data segment specifies the initial values of a range of bytes
in a memory object.</p>
</div>
<div class="sect3">
<h4 id="wasm_data">WASM-DATA</h4>
<div class="paragraph">
<p>Structure <code>WASM-DATA</code></p>
</div>
<div class="paragraph">
<p>Represents a data segment.</p>
</div>
<div class="dlist">
<div class="title">Slots</div>
<dl>
<dt class="hdlist1"><code>MODE</code></dt>
<dd>
<p>Keyword specifying the element segment mode.</p>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>:ACTIVE</code></dt>
<dd>
<p>An 'active' segment, which is used to initialize the
memory object during module instantiation. This is the default.</p>
</dd>
<dt class="hdlist1"><code>:PASSIVE</code></dt>
<dd>
<p>A 'passive' segment, which can be used to initialize the
memory object at runtime with the <code>MEMORY.INIT</code> instruction.</p>
</dd>
</dl>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>MEMORY</code></dt>
<dd>
<p>Index of the memory object, 0 by default, which this element
initializes. This slot is only used when <code>MODE</code> is <code>:ACTIVE</code>.</p>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the current version of WebAssembly the only valid index is 0.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>OFFSET</code></dt>
<dd>
<p>Expression which computes the starting index of the
location within the memory object where the bytes in this segment are
copied to.</p>
</dd>
<dt class="hdlist1"><code>BYTES</code></dt>
<dd>
<p>Byte array containing the values to which the bytes in the
memory object are set.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-05-08 16:49:21 +0200
</div>
</div>
</body>
</html>